(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[37],{gmvE:function(e,t,a){"use strict";var n=a("tAuX"),l=a("g09b");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("jCWc");var u=l(a("kPKH"));a("14J3");var r=l(a("BMrR"));a("iQDF");var o=l(a("+eQT"));a("7Kak");var c=l(a("9yH6"));a("IzEo");var s=l(a("bx4M")),d=l(a("qIgq"));a("Znn+");var i=l(a("ZTPi")),m=n(a("q1tI")),f=l(a("g57k")),g=l(a("CLrh")),v=l(a("wd/R")),D=a("yP6+"),p=i.default.TabPane,y=function(e){var t,a=e.loading,n={gatewayDataList:[],ticksDataList:[],currentTime:"",time:"",selectionTime:""},l=(0,m.useState)(n.gatewayDataList),y=(0,d.default)(l,2),E=y[0],h=y[1],M=(0,m.useState)(n.ticksDataList),H=(0,d.default)(M,2),w=H[0],S=H[1],b=(0,m.useState)(n.time),k=(0,d.default)(b,2),Y=k[0],B=k[1],L=(0,m.useState)(n.selectionTime),T=(0,d.default)(L,2),F=T[0],x=T[1],C=function(e){var t=new Date;return t.setDate(t.getDate()-e),"".concat(t.getFullYear(),"-").concat(t.getMonth()+1<10?"0".concat(t.getMonth()+1):t.getMonth()+1,"-").concat(t.getDate()<10?"0".concat(t.getDate()):t.getDate()," ").concat(t.getHours()<10?"0".concat(t.getHours()):t.getHours(),":").concat(t.getMinutes()<10?"0".concat(t.getMinutes()):t.getMinutes(),":").concat(t.getSeconds()<10?"0".concat(t.getSeconds()):t.getSeconds())},P={"1h":"1m","1d":"24m","7d":"168m","30d":"12h"};function G(e){var a=e.target.value;B(P[a]);var n=new Date(F);"1h"===a?n.setHours(n.getHours()-1):"1d"===a?n.setDate(n.getDate()-1):"7d"===a?n.setDate(n.getDate()-7):"30d"===a&&n.setDate(n.getDate()-30),t(N(n),N(new Date),P[a])}(0,m.useEffect)(function(){var e=new Date;e.setHours(e.getHours()-1),t(N(e),C(0),"1m"),x(C(0)),B("1m")},[]),t=function(e,t,a){var n="";n="1m"===a?"HH\u65f6mm\u5206":"12h"===a?"MM\u6708dd\u65e5HH\u65f6":"MM\u6708dd\u65e5HH\u65f6mm\u5206";var l=[{dashboard:"gatewayMonitor",object:"deviceGateway",measurement:"received_message",dimension:"agg",group:"sameDay",params:{time:a||"1m",limit:60,format:n,from:e,to:t}}];g.default.analysis.getMulti(l).then(function(e){var t=null===e||void 0===e?void 0:e.result;if(200===e.status){var a=[],n=[];t.forEach(function(e){a.push({year:e.data.timeString,value:e.data.value,type:"\u6d88\u606f\u91cf"}),e.data.timestamp%4===0&&0!==e.data.timestamp&&n.push(e.data.timeString)}),S(n),h(a)}})};var N=function(e){var t=new Date(e);return"".concat(t.getFullYear(),"-").concat(t.getMonth()+1<10?"0".concat(t.getMonth()+1):t.getMonth()+1,"-").concat(t.getDate()<10?"0".concat(t.getDate()):t.getDate()," ").concat(t.getHours()<10?"0".concat(t.getHours()):t.getHours(),":").concat(t.getMinutes()<10?"0".concat(t.getMinutes()):t.getMinutes(),":").concat(t.getSeconds()<10?"0".concat(t.getSeconds()):t.getSeconds())};function j(e){x(e);var a=new Date(e);"1m"===Y?a.setHours(a.getHours()-1):"24m"===Y?a.setDate(a.getDate()-1):"168m"===Y?a.setDate(a.getDate()-7):"12h"===Y&&a.setDate(a.getDate()-30),t(N(a),N(e),Y)}return m.default.createElement(s.default,{loading:a,bordered:!1,bodyStyle:{padding:0}},m.default.createElement("div",{className:f.default.salesCard},m.default.createElement(i.default,{tabBarExtraContent:m.default.createElement("div",{className:f.default.salesExtraWrap},m.default.createElement("div",{className:f.default.salesExtra},m.default.createElement(c.default.Group,{defaultValue:"1h",onChange:G},m.default.createElement(c.default.Button,{value:"1h"},"1\u5c0f\u65f6"),m.default.createElement(c.default.Button,{value:"1d"},"1\u5929"),m.default.createElement(c.default.Button,{value:"7d"},"7\u5929"),m.default.createElement(c.default.Button,{value:"30d"},"30\u5929"))),m.default.createElement(o.default,{showTime:!0,defaultValue:(0,v.default)(new Date,"YYYY-MM-DD HH:mm:ss"),placeholder:"\u7ed3\u675f\u65f6\u95f4",onOk:j,format:"YYYY-MM-DD HH:mm:ss"})),size:"large",tabBarStyle:{marginBottom:24}},m.default.createElement(p,{tab:"\u8bbe\u5907\u6d88\u606f",key:"sales"},m.default.createElement(r.default,null,m.default.createElement(u.default,null,m.default.createElement("div",{className:f.default.salesBar},m.default.createElement(D.Chart,{height:400,data:E,scale:{value:{min:0},year:{range:[0,1],ticks:w}},forceFit:!0},m.default.createElement(D.Axis,{name:"year"}),m.default.createElement(D.Axis,{name:"value",label:{formatter:function(e){return parseFloat(e).toLocaleString()}}}),m.default.createElement(D.Legend,null),m.default.createElement(D.Tooltip,{crosshairs:{type:"y"}}),m.default.createElement(D.Geom,{type:"line",position:"year*value*type",size:2,tooltip:["year*value*type",function(e,t,a){return{title:e,name:a,value:parseFloat(t).toLocaleString()}}]}),m.default.createElement(D.Geom,{type:"area",position:"year*value*type",shape:"circle",tooltip:["year*value*type",function(e,t,a){return{title:e,name:a,value:parseFloat(t).toLocaleString()}}]})))))))))},E=y;t.default=E}}]);